%table.table{id: 'import_empty_containers_table'}
  %thead
    %th BL Number
    %th Container Number
    %th Customer Name
    %th G/F Expiry
    %th
    %th
    %th
  %tbody
    - @import_items.each do |item|
      - updated_at = status_updated_at(item).strftime("%d-%m-%Y")
      %tr{id: item.id}
        %td= item.import.bl_number
        %td= item.container_number
        %td= item.import.customer.name
        %td= updated_at
        %td.emptyReturn{class: "text-center"}
          %button.btn.btn-small.btn-primary{"data-target" => "#context", "data-toggle"=>"modal", "data-after-delivery"=>"empty_return", "data-item-id"=> "#{item.id}"}  Empty Return
        %td.exportReuse{class: "text-center"}
          %button.btn.btn-small.btn-primary{"data-target" => "#context", "data-toggle"=>"modal", "data-after-delivery"=>"export_reuse", "data-item-id"=> "#{item.id}"} Export Reuse
        %td.dropOff{class: "text-center"}
          %button.btn.btn-small.btn-primary{"data-target" => "#context", "data-toggle"=>"modal", "data-after-delivery"=>"drop_off", "data-item-id"=> "#{item.id}"} Drop Off


#context.modal{"aria-hidden" => "true", "aria-labelledby" => "basicModal", role: "dialog", tabindex: "-1"}
  .modal-dialog
    = simple_form_for(:import_item, url: '', html: { class: 'form-horizontal'}, remote: true, defaults: {input_html: {class: 'form-control'}}) do |f|
      .modal-content
        .modal-header
          = link_to 'Ã—', 'javascript:void(0)', class: 'close', data: {dismiss: 'modal'}
          #title_modal
            %h1.modal-title  
        .modal-body
          = f.input :context
          #some_field.hide
            = f.input :transporter_name 
        .modal-footer
          = link_to 'Cancel', 'javascript:void(0)', class: 'btn btn-primary', data: {dismiss: 'modal'}
          = f.submit 'Save', class: 'btn btn-primary'

        
:coffeescript
  $('#context').on 'show.bs.modal', (event) ->
    link_tag = $(event.relatedTarget)
    after_delivery = link_tag.attr('data-after-delivery').toString()  
    id = link_tag.attr('data-item-id')
    $('#title_modal .modal-title').html(after_delivery)
    if (after_delivery == "export_reuse")
      $('#context .control-label').html('Customer Name')
    else if(after_delivery == "drop_off")
      $('#context .control-label').html('Yard Name')
    else 
      $('#context .control-label').html('Truck Number') 
  
    $('#context form').attr('action', "/import_items/" + id + "/updateContext?after_delivery=" + after_delivery)


