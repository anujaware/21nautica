= simple_nested_form_for @import , html: {class: 'form-horizontal'}, defaults: {input_html: {class: 'form-control'}} do |f|
  %div{data: {for: 'customerSelect'}}
    = render '/shared/customer', customers: @customers, model: 'import'

  = f.input :to, input_html: {:"data-validation" => "required", :"data-validation-error-msg" => "This field is mandatory."}

  = f.input :from, input_html: {:"data-validation" => "required", :"data-validation-error-msg" => "This field is mandatory."}

  = f.input :bl_number, label: 'BL- Number', input_html: {:"data-validation" => "required", :"data-validation-error-msg" => "This field is mandatory."}
  
  = f.input :shipping_line, collection: SHIPPING_LINE, as: :select, label: 'Shipping line', include_blank: false

  = f.input :estimate_arrival, as: :string, input_html: { class: 'date', data: {behaviour: "datepicker"}}
  
  = f.input :equipment, collection: EQUIPMENT_TYPE, as: :select, label: 'Equipment', include_blank: false
  
  = f.input :quantity, input_html: {:"data-validation" => "number", :"data-validation-error-msg" => "Quantity Should be a valid Positive Number."}  
          
  = f.fields_for :import_items do |items_form|
    = items_form.text_field :container_number
  
  = f.link_to_add "Add Container", :import_items
    
  = f.input :description, label: 'Description'
  .form-group
    .col-sm-offset-2.col-sm-2
      = f.submit 'Save', class: 'btn-primary'


:coffeescript  
  $('#import_quantity').on 'blur', (event) ->
    existing_count = $('.fields').size()
    quantity = this.value
    console.log quantity 
    i = 0
    if quantity > existing_count
      while i < (quantity - existing_count)
        $('.add_nested_fields').click()
        i++
    else
      extras = existing_count - quantity 
      while i < (extras)
        $('.fields')[i].remove()
        i++    

  $('#new_import').on 'submit', (event) ->
    i = 0

    while i < $('.fields').size() 
      if( $('.fields input')[i].value == "" )
        alert('Please fill in all container numbers')
        event.preventDefault()
      i++ 
    